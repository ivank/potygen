// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Sql Files Should parse complex sql account-levelisations.query.sql: account-levelisations.query.sql 1`] = `
Object {
  "tag": "Select",
  "values": Array [
    Object {
      "tag": "SelectList",
      "values": Array [
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "id",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "id",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "levelisationId",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "levelisation_id",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "accountId",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "account_id",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "installationId",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "installation_id",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "state",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "state",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "isAccepted",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "is_accepted",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "generationStartReadOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "generation_start_read_on",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "generationStartReadValue",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "generation_start_read_value",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "generationEndReadOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "generation_end_read_on",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "generationEndReadValue",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "generation_end_read_value",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "generationPercentageSplit",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "generation_percentage_split",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "generationPayment",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "generation_payment",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "generationEnergy",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "generation_energy",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "exportStartReadOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "export_start_read_on",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "exportStartReadValue",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "export_start_read_value",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "exportEndReadOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "export_end_read_on",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "exportEndReadValue",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "export_end_read_value",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "exportPercentageSplit",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "export_percentage_split",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "exportPayment",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "export_payment",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "exportEnergy",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "export_energy",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "totalPayment",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "total_payment",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "vatPayment",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "vat_payment",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "cfrFitId",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contracts",
              },
              Object {
                "tag": "Identifier",
                "value": "scheme_account_reference",
              },
            ],
          },
        },
      ],
    },
    Object {
      "join": Array [
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contracts",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": undefined,
          },
          "values": Array [
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "account_levelisations",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "installation_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "contracts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "installation_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
      ],
      "list": Object {
        "tag": "FromList",
        "values": Array [
          Object {
            "as": undefined,
            "tag": "FromListItem",
            "value": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "account_levelisations",
                },
              ],
            },
          },
        ],
      },
      "tag": "From",
    },
    Object {
      "tag": "Where",
      "value": Object {
        "left": Object {
          "left": Object {
            "left": Object {
              "left": Object {
                "tag": "Parameter",
                "type": "native",
                "value": "q",
              },
              "operator": Object {
                "tag": "Operator",
                "value": "=",
              },
              "right": Object {
                "tag": "String",
                "value": "",
              },
              "tag": "BinaryExpression",
            },
            "operator": Object {
              "tag": "Operator",
              "value": "OR",
            },
            "right": Object {
              "left": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "contracts",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "scheme_account_reference",
                  },
                ],
              },
              "operator": Object {
                "tag": "Operator",
                "value": "=",
              },
              "right": Object {
                "tag": "Parameter",
                "type": "native",
                "value": "q",
              },
              "tag": "BinaryExpression",
            },
            "tag": "BinaryExpression",
          },
          "operator": Object {
            "tag": "Operator",
            "value": "AND",
          },
          "right": Object {
            "left": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "account_levelisations",
                },
                Object {
                  "tag": "Identifier",
                  "value": "levelisation_id",
                },
              ],
            },
            "operator": Object {
              "tag": "Operator",
              "value": "=",
            },
            "right": Object {
              "tag": "Parameter",
              "type": "native",
              "value": "levelisationId",
            },
            "tag": "BinaryExpression",
          },
          "tag": "BinaryExpression",
        },
        "operator": Object {
          "tag": "Operator",
          "value": "AND",
        },
        "right": Object {
          "left": Object {
            "left": Object {
              "args": Array [
                Object {
                  "tag": "PgCast",
                  "type": Object {
                    "dimensions": 1,
                    "tag": "TypeArray",
                    "value": Object {
                      "param": undefined,
                      "tag": "Type",
                      "value": "int",
                    },
                  },
                  "value": Object {
                    "tag": "Parameter",
                    "type": "native",
                    "value": "ids",
                  },
                },
              ],
              "tag": "Function",
              "value": Object {
                "tag": "Identifier",
                "value": "cardinality",
              },
            },
            "operator": Object {
              "tag": "Operator",
              "value": "=",
            },
            "right": Object {
              "tag": "Number",
              "value": "0",
            },
            "tag": "BinaryExpression",
          },
          "operator": Object {
            "tag": "Operator",
            "value": "OR",
          },
          "right": Object {
            "left": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "account_levelisations",
                },
                Object {
                  "tag": "Identifier",
                  "value": "id",
                },
              ],
            },
            "operator": Object {
              "tag": "Operator",
              "value": "=",
            },
            "right": Object {
              "args": Array [
                Object {
                  "tag": "PgCast",
                  "type": Object {
                    "dimensions": 1,
                    "tag": "TypeArray",
                    "value": Object {
                      "param": undefined,
                      "tag": "Type",
                      "value": "int",
                    },
                  },
                  "value": Object {
                    "tag": "Parameter",
                    "type": "native",
                    "value": "ids",
                  },
                },
              ],
              "tag": "Function",
              "value": Object {
                "tag": "Identifier",
                "value": "ANY",
              },
            },
            "tag": "BinaryExpression",
          },
          "tag": "BinaryExpression",
        },
        "tag": "BinaryExpression",
      },
    },
    Object {
      "tag": "OrderBy",
      "values": Array [
        Object {
          "direction": Object {
            "tag": "OrderDirection",
            "value": "DESC",
          },
          "tag": "OrderByItem",
          "value": Object {
            "tag": "Case",
            "values": Array [
              Object {
                "condition": Object {
                  "left": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortField",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "cfrFitId",
                    },
                    "tag": "BinaryExpression",
                  },
                  "operator": Object {
                    "tag": "Operator",
                    "value": "AND",
                  },
                  "right": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortOrder",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "DESC",
                    },
                    "tag": "BinaryExpression",
                  },
                  "tag": "BinaryExpression",
                },
                "tag": "When",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "contracts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "scheme_account_reference",
                    },
                  ],
                },
              },
            ],
          },
        },
        Object {
          "direction": Object {
            "tag": "OrderDirection",
            "value": "ASC",
          },
          "tag": "OrderByItem",
          "value": Object {
            "tag": "Case",
            "values": Array [
              Object {
                "condition": Object {
                  "left": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortField",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "cfrFitId",
                    },
                    "tag": "BinaryExpression",
                  },
                  "operator": Object {
                    "tag": "Operator",
                    "value": "AND",
                  },
                  "right": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortOrder",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "ASC",
                    },
                    "tag": "BinaryExpression",
                  },
                  "tag": "BinaryExpression",
                },
                "tag": "When",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "contracts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "scheme_account_reference",
                    },
                  ],
                },
              },
            ],
          },
        },
        Object {
          "direction": Object {
            "tag": "OrderDirection",
            "value": "DESC",
          },
          "tag": "OrderByItem",
          "value": Object {
            "tag": "Case",
            "values": Array [
              Object {
                "condition": Object {
                  "left": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortField",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "state",
                    },
                    "tag": "BinaryExpression",
                  },
                  "operator": Object {
                    "tag": "Operator",
                    "value": "AND",
                  },
                  "right": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortOrder",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "DESC",
                    },
                    "tag": "BinaryExpression",
                  },
                  "tag": "BinaryExpression",
                },
                "tag": "When",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "account_levelisations",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "state",
                    },
                  ],
                },
              },
            ],
          },
        },
        Object {
          "direction": Object {
            "tag": "OrderDirection",
            "value": "ASC",
          },
          "tag": "OrderByItem",
          "value": Object {
            "tag": "Case",
            "values": Array [
              Object {
                "condition": Object {
                  "left": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortField",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "state",
                    },
                    "tag": "BinaryExpression",
                  },
                  "operator": Object {
                    "tag": "Operator",
                    "value": "AND",
                  },
                  "right": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortOrder",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "ASC",
                    },
                    "tag": "BinaryExpression",
                  },
                  "tag": "BinaryExpression",
                },
                "tag": "When",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "account_levelisations",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "state",
                    },
                  ],
                },
              },
            ],
          },
        },
        Object {
          "direction": Object {
            "tag": "OrderDirection",
            "value": "DESC",
          },
          "tag": "OrderByItem",
          "value": Object {
            "tag": "Case",
            "values": Array [
              Object {
                "condition": Object {
                  "left": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortField",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "isAccepted",
                    },
                    "tag": "BinaryExpression",
                  },
                  "operator": Object {
                    "tag": "Operator",
                    "value": "AND",
                  },
                  "right": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortOrder",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "DESC",
                    },
                    "tag": "BinaryExpression",
                  },
                  "tag": "BinaryExpression",
                },
                "tag": "When",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "account_levelisations",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "is_accepted",
                    },
                  ],
                },
              },
            ],
          },
        },
        Object {
          "direction": Object {
            "tag": "OrderDirection",
            "value": "ASC",
          },
          "tag": "OrderByItem",
          "value": Object {
            "tag": "Case",
            "values": Array [
              Object {
                "condition": Object {
                  "left": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortField",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "isAccepted",
                    },
                    "tag": "BinaryExpression",
                  },
                  "operator": Object {
                    "tag": "Operator",
                    "value": "AND",
                  },
                  "right": Object {
                    "left": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "sortOrder",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "String",
                      "value": "ASC",
                    },
                    "tag": "BinaryExpression",
                  },
                  "tag": "BinaryExpression",
                },
                "tag": "When",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "account_levelisations",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "is_accepted",
                    },
                  ],
                },
              },
            ],
          },
        },
      ],
    },
    Object {
      "tag": "Limit",
      "value": Object {
        "tag": "Count",
        "value": Object {
          "tag": "PgCast",
          "type": Object {
            "param": undefined,
            "tag": "Type",
            "value": "int",
          },
          "value": Object {
            "tag": "Parameter",
            "type": "native",
            "value": "limit",
          },
        },
      },
    },
    Object {
      "tag": "Offset",
      "value": Object {
        "tag": "Count",
        "value": Object {
          "tag": "PgCast",
          "type": Object {
            "param": undefined,
            "tag": "Type",
            "value": "int",
          },
          "value": Object {
            "tag": "Parameter",
            "type": "native",
            "value": "offset",
          },
        },
      },
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql account-levelisations-set-bulk-update.query.sql: account-levelisations-set-bulk-update.query.sql 1`] = `
Object {
  "tag": "Update",
  "values": Array [
    Object {
      "as": undefined,
      "tag": "Table",
      "value": Object {
        "tag": "QualifiedIdentifier",
        "values": Array [
          Object {
            "tag": "Identifier",
            "value": "account_levelisations",
          },
        ],
      },
    },
    Object {
      "tag": "Set",
      "value": Object {
        "tag": "SetList",
        "values": Array [
          Object {
            "column": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "is_cheque_payments_sent",
                },
              ],
            },
            "tag": "SetItem",
            "value": Object {
              "tag": "Case",
              "values": Array [
                Object {
                  "condition": Object {
                    "subquery": Object {
                      "tag": "Select",
                      "values": Array [
                        Object {
                          "tag": "SelectList",
                          "values": Array [
                            Object {
                              "as": undefined,
                              "tag": "SelectListItem",
                              "value": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "id",
                                  },
                                ],
                              },
                            },
                          ],
                        },
                        Object {
                          "join": Array [],
                          "list": Object {
                            "tag": "FromList",
                            "values": Array [
                              Object {
                                "as": undefined,
                                "tag": "FromListItem",
                                "value": Object {
                                  "tag": "QualifiedIdentifier",
                                  "values": Array [
                                    Object {
                                      "tag": "Identifier",
                                      "value": "accounts",
                                    },
                                  ],
                                },
                              },
                            ],
                          },
                          "tag": "From",
                        },
                        Object {
                          "tag": "Where",
                          "value": Object {
                            "left": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "accounts",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "id",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "account_levelisations",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "account_id",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "AND",
                            },
                            "right": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "payment_plan",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "String",
                                "value": "Cheque",
                              },
                              "tag": "BinaryExpression",
                            },
                            "tag": "BinaryExpression",
                          },
                        },
                      ],
                    },
                    "tag": "SubqueryExpression",
                    "type": "exists",
                  },
                  "tag": "When",
                  "value": Object {
                    "tag": "Boolean",
                    "value": "TRUE",
                  },
                },
                Object {
                  "tag": "Else",
                  "value": Object {
                    "tag": "Null",
                  },
                },
              ],
            },
          },
          Object {
            "column": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "is_bacs_payments_sent",
                },
              ],
            },
            "tag": "SetItem",
            "value": Object {
              "tag": "Case",
              "values": Array [
                Object {
                  "condition": Object {
                    "subquery": Object {
                      "tag": "Select",
                      "values": Array [
                        Object {
                          "tag": "SelectList",
                          "values": Array [
                            Object {
                              "as": undefined,
                              "tag": "SelectListItem",
                              "value": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "id",
                                  },
                                ],
                              },
                            },
                          ],
                        },
                        Object {
                          "join": Array [],
                          "list": Object {
                            "tag": "FromList",
                            "values": Array [
                              Object {
                                "as": undefined,
                                "tag": "FromListItem",
                                "value": Object {
                                  "tag": "QualifiedIdentifier",
                                  "values": Array [
                                    Object {
                                      "tag": "Identifier",
                                      "value": "accounts",
                                    },
                                  ],
                                },
                              },
                            ],
                          },
                          "tag": "From",
                        },
                        Object {
                          "tag": "Where",
                          "value": Object {
                            "left": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "accounts",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "id",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "account_levelisations",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "account_id",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "AND",
                            },
                            "right": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "payment_plan",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "String",
                                "value": "BACs",
                              },
                              "tag": "BinaryExpression",
                            },
                            "tag": "BinaryExpression",
                          },
                        },
                      ],
                    },
                    "tag": "SubqueryExpression",
                    "type": "exists",
                  },
                  "tag": "When",
                  "value": Object {
                    "tag": "Boolean",
                    "value": "TRUE",
                  },
                },
                Object {
                  "tag": "Else",
                  "value": Object {
                    "tag": "Null",
                  },
                },
              ],
            },
          },
        ],
      },
    },
    Object {
      "tag": "Where",
      "value": Object {
        "left": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "account_levelisations",
              },
              Object {
                "tag": "Identifier",
                "value": "id",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "=",
          },
          "right": Object {
            "args": Array [
              Object {
                "tag": "PgCast",
                "type": Object {
                  "dimensions": 1,
                  "tag": "TypeArray",
                  "value": Object {
                    "param": undefined,
                    "tag": "Type",
                    "value": "int",
                  },
                },
                "value": Object {
                  "tag": "Parameter",
                  "type": "native",
                  "value": "ids",
                },
              },
            ],
            "tag": "Function",
            "value": Object {
              "tag": "Identifier",
              "value": "ANY",
            },
          },
          "tag": "BinaryExpression",
        },
        "operator": Object {
          "tag": "Operator",
          "value": "AND",
        },
        "right": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "is_accepted",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "=",
          },
          "right": Object {
            "tag": "Boolean",
            "value": "true",
          },
          "tag": "BinaryExpression",
        },
        "tag": "BinaryExpression",
      },
    },
    Object {
      "tag": "Returning",
      "values": Array [
        Object {
          "as": undefined,
          "tag": "ReturningListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "id",
              },
            ],
          },
        },
      ],
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql accounts.query.sql: accounts.query.sql 1`] = `
Object {
  "tag": "Select",
  "values": Array [
    Object {
      "tag": "Distinct",
      "values": Array [
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "accounts",
            },
            Object {
              "tag": "Identifier",
              "value": "id",
            },
          ],
        },
      ],
    },
    Object {
      "tag": "SelectList",
      "values": Array [
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "accounts",
              },
              Object {
                "tag": "Identifier",
                "value": "id",
              },
            ],
          },
        },
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "accounts",
              },
              Object {
                "tag": "Identifier",
                "value": "state",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "startOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "accounts",
              },
              Object {
                "tag": "Identifier",
                "value": "start_on",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "firstName",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contacts",
              },
              Object {
                "tag": "Identifier",
                "value": "first_name",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "lastName",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contacts",
              },
              Object {
                "tag": "Identifier",
                "value": "last_name",
              },
            ],
          },
        },
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contacts",
              },
              Object {
                "tag": "Identifier",
                "value": "email",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "address",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "args": Array [
              Object {
                "tag": "String",
                "value": " ",
              },
              Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "installation_addresses",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "address_line_1",
                  },
                ],
              },
              Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "installation_addresses",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "address_line_2",
                  },
                ],
              },
              Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "installation_addresses",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "city",
                  },
                ],
              },
              Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "installation_addresses",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "postcode",
                  },
                ],
              },
            ],
            "tag": "Function",
            "value": Object {
              "tag": "Identifier",
              "value": "CONCAT_WS",
            },
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "fitIds",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "args": Array [
              Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "contracts",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "scheme_account_reference",
                  },
                ],
              },
            ],
            "tag": "Function",
            "value": Object {
              "tag": "Identifier",
              "value": "ARRAY_AGG",
            },
          },
        },
      ],
    },
    Object {
      "join": Array [
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "customers",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": undefined,
          },
          "values": Array [
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "customers",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "accounts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "customer_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contacts",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": undefined,
          },
          "values": Array [
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "contacts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "customers",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "primary_contact_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "addresses",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": undefined,
          },
          "values": Array [
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "addresses",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "contacts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "address_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contracts",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": undefined,
          },
          "values": Array [
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "contracts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "account_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "accounts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "installations",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": undefined,
          },
          "values": Array [
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "contracts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "installation_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "installations",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "addresses",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": undefined,
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "installation_addresses",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "installations",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "address_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "installation_addresses",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
      ],
      "list": Object {
        "tag": "FromList",
        "values": Array [
          Object {
            "as": undefined,
            "tag": "FromListItem",
            "value": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "accounts",
                },
              ],
            },
          },
        ],
      },
      "tag": "From",
    },
    Object {
      "tag": "Where",
      "value": Object {
        "left": Object {
          "left": Object {
            "left": Object {
              "tag": "Parameter",
              "type": "native",
              "value": "q",
            },
            "operator": Object {
              "tag": "Operator",
              "value": "=",
            },
            "right": Object {
              "tag": "String",
              "value": "",
            },
            "tag": "BinaryExpression",
          },
          "operator": Object {
            "tag": "Operator",
            "value": "OR",
          },
          "right": Object {
            "left": Object {
              "left": Object {
                "left": Object {
                  "left": Object {
                    "left": Object {
                      "left": Object {
                        "left": Object {
                          "left": Object {
                            "left": Object {
                              "args": Array [
                                Object {
                                  "tag": "String",
                                  "value": "english",
                                },
                                Object {
                                  "tag": "QualifiedIdentifier",
                                  "values": Array [
                                    Object {
                                      "tag": "Identifier",
                                      "value": "accounts",
                                    },
                                    Object {
                                      "tag": "Identifier",
                                      "value": "beneficiary_name",
                                    },
                                  ],
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "to_tsvector",
                              },
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "@@",
                            },
                            "right": Object {
                              "args": Array [
                                Object {
                                  "tag": "String",
                                  "value": "english",
                                },
                                Object {
                                  "tag": "Parameter",
                                  "type": "native",
                                  "value": "q",
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "plainto_tsquery",
                              },
                            },
                            "tag": "BinaryExpression",
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "OR",
                          },
                          "right": Object {
                            "left": Object {
                              "args": Array [
                                Object {
                                  "tag": "String",
                                  "value": "english",
                                },
                                Object {
                                  "args": Array [
                                    Object {
                                      "tag": "String",
                                      "value": " ",
                                    },
                                    Object {
                                      "tag": "QualifiedIdentifier",
                                      "values": Array [
                                        Object {
                                          "tag": "Identifier",
                                          "value": "contacts",
                                        },
                                        Object {
                                          "tag": "Identifier",
                                          "value": "first_name",
                                        },
                                      ],
                                    },
                                    Object {
                                      "tag": "QualifiedIdentifier",
                                      "values": Array [
                                        Object {
                                          "tag": "Identifier",
                                          "value": "contacts",
                                        },
                                        Object {
                                          "tag": "Identifier",
                                          "value": "last_name",
                                        },
                                      ],
                                    },
                                    Object {
                                      "tag": "QualifiedIdentifier",
                                      "values": Array [
                                        Object {
                                          "tag": "Identifier",
                                          "value": "contacts",
                                        },
                                        Object {
                                          "tag": "Identifier",
                                          "value": "email",
                                        },
                                      ],
                                    },
                                    Object {
                                      "tag": "QualifiedIdentifier",
                                      "values": Array [
                                        Object {
                                          "tag": "Identifier",
                                          "value": "contacts",
                                        },
                                        Object {
                                          "tag": "Identifier",
                                          "value": "phone",
                                        },
                                      ],
                                    },
                                  ],
                                  "tag": "Function",
                                  "value": Object {
                                    "tag": "Identifier",
                                    "value": "CONCAT_WS",
                                  },
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "to_tsvector",
                              },
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "@@",
                            },
                            "right": Object {
                              "args": Array [
                                Object {
                                  "tag": "String",
                                  "value": "english",
                                },
                                Object {
                                  "tag": "Parameter",
                                  "type": "native",
                                  "value": "q",
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "plainto_tsquery",
                              },
                            },
                            "tag": "BinaryExpression",
                          },
                          "tag": "BinaryExpression",
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "OR",
                        },
                        "right": Object {
                          "left": Object {
                            "args": Array [
                              Object {
                                "tag": "String",
                                "value": "english",
                              },
                              Object {
                                "args": Array [
                                  Object {
                                    "tag": "String",
                                    "value": " ",
                                  },
                                  Object {
                                    "tag": "QualifiedIdentifier",
                                    "values": Array [
                                      Object {
                                        "tag": "Identifier",
                                        "value": "addresses",
                                      },
                                      Object {
                                        "tag": "Identifier",
                                        "value": "address_line_1",
                                      },
                                    ],
                                  },
                                  Object {
                                    "tag": "QualifiedIdentifier",
                                    "values": Array [
                                      Object {
                                        "tag": "Identifier",
                                        "value": "addresses",
                                      },
                                      Object {
                                        "tag": "Identifier",
                                        "value": "address_line_2",
                                      },
                                    ],
                                  },
                                  Object {
                                    "tag": "QualifiedIdentifier",
                                    "values": Array [
                                      Object {
                                        "tag": "Identifier",
                                        "value": "addresses",
                                      },
                                      Object {
                                        "tag": "Identifier",
                                        "value": "city",
                                      },
                                    ],
                                  },
                                ],
                                "tag": "Function",
                                "value": Object {
                                  "tag": "Identifier",
                                  "value": "CONCAT_WS",
                                },
                              },
                            ],
                            "tag": "Function",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "to_tsvector",
                            },
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "@@",
                          },
                          "right": Object {
                            "args": Array [
                              Object {
                                "tag": "String",
                                "value": "english",
                              },
                              Object {
                                "tag": "Parameter",
                                "type": "native",
                                "value": "q",
                              },
                            ],
                            "tag": "Function",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "plainto_tsquery",
                            },
                          },
                          "tag": "BinaryExpression",
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "OR",
                      },
                      "right": Object {
                        "left": Object {
                          "args": Array [
                            Object {
                              "tag": "String",
                              "value": "english",
                            },
                            Object {
                              "args": Array [
                                Object {
                                  "tag": "String",
                                  "value": " ",
                                },
                                Object {
                                  "tag": "QualifiedIdentifier",
                                  "values": Array [
                                    Object {
                                      "tag": "Identifier",
                                      "value": "installation_addresses",
                                    },
                                    Object {
                                      "tag": "Identifier",
                                      "value": "address_line_1",
                                    },
                                  ],
                                },
                                Object {
                                  "tag": "QualifiedIdentifier",
                                  "values": Array [
                                    Object {
                                      "tag": "Identifier",
                                      "value": "installation_addresses",
                                    },
                                    Object {
                                      "tag": "Identifier",
                                      "value": "address_line_2",
                                    },
                                  ],
                                },
                                Object {
                                  "tag": "QualifiedIdentifier",
                                  "values": Array [
                                    Object {
                                      "tag": "Identifier",
                                      "value": "installation_addresses",
                                    },
                                    Object {
                                      "tag": "Identifier",
                                      "value": "city",
                                    },
                                  ],
                                },
                                Object {
                                  "tag": "QualifiedIdentifier",
                                  "values": Array [
                                    Object {
                                      "tag": "Identifier",
                                      "value": "installation_addresses",
                                    },
                                    Object {
                                      "tag": "Identifier",
                                      "value": "postcode",
                                    },
                                  ],
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "CONCAT_WS",
                              },
                            },
                          ],
                          "tag": "Function",
                          "value": Object {
                            "tag": "Identifier",
                            "value": "to_tsvector",
                          },
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "@@",
                        },
                        "right": Object {
                          "args": Array [
                            Object {
                              "tag": "String",
                              "value": "english",
                            },
                            Object {
                              "tag": "Parameter",
                              "type": "native",
                              "value": "q",
                            },
                          ],
                          "tag": "Function",
                          "value": Object {
                            "tag": "Identifier",
                            "value": "plainto_tsquery",
                          },
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "OR",
                    },
                    "right": Object {
                      "left": Object {
                        "tag": "PgCast",
                        "type": Object {
                          "param": undefined,
                          "tag": "Type",
                          "value": "varchar",
                        },
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "accounts",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "Parameter",
                        "type": "native",
                        "value": "q",
                      },
                      "tag": "BinaryExpression",
                    },
                    "tag": "BinaryExpression",
                  },
                  "operator": Object {
                    "tag": "Operator",
                    "value": "OR",
                  },
                  "right": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "installations",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "supply_mpan",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "Parameter",
                      "type": "native",
                      "value": "q",
                    },
                    "tag": "BinaryExpression",
                  },
                  "tag": "BinaryExpression",
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "OR",
                },
                "right": Object {
                  "left": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "installations",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "export_mpan",
                      },
                    ],
                  },
                  "operator": Object {
                    "tag": "Operator",
                    "value": "=",
                  },
                  "right": Object {
                    "tag": "Parameter",
                    "type": "native",
                    "value": "q",
                  },
                  "tag": "BinaryExpression",
                },
                "tag": "BinaryExpression",
              },
              "operator": Object {
                "tag": "Operator",
                "value": "OR",
              },
              "right": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "accounts",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "beneficiary_account_number",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "Parameter",
                  "type": "native",
                  "value": "q",
                },
                "tag": "BinaryExpression",
              },
              "tag": "BinaryExpression",
            },
            "operator": Object {
              "tag": "Operator",
              "value": "OR",
            },
            "right": Object {
              "left": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "contracts",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "scheme_account_reference",
                  },
                ],
              },
              "operator": Object {
                "tag": "Operator",
                "value": "=",
              },
              "right": Object {
                "tag": "Parameter",
                "type": "native",
                "value": "q",
              },
              "tag": "BinaryExpression",
            },
            "tag": "BinaryExpression",
          },
          "tag": "BinaryExpression",
        },
        "operator": Object {
          "tag": "Operator",
          "value": "AND",
        },
        "right": Object {
          "left": Object {
            "left": Object {
              "args": Array [
                Object {
                  "tag": "PgCast",
                  "type": Object {
                    "dimensions": 1,
                    "tag": "TypeArray",
                    "value": Object {
                      "param": undefined,
                      "tag": "Type",
                      "value": "int",
                    },
                  },
                  "value": Object {
                    "tag": "Parameter",
                    "type": "native",
                    "value": "ids",
                  },
                },
              ],
              "tag": "Function",
              "value": Object {
                "tag": "Identifier",
                "value": "cardinality",
              },
            },
            "operator": Object {
              "tag": "Operator",
              "value": "=",
            },
            "right": Object {
              "tag": "Number",
              "value": "0",
            },
            "tag": "BinaryExpression",
          },
          "operator": Object {
            "tag": "Operator",
            "value": "OR",
          },
          "right": Object {
            "left": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "accounts",
                },
                Object {
                  "tag": "Identifier",
                  "value": "id",
                },
              ],
            },
            "operator": Object {
              "tag": "Operator",
              "value": "=",
            },
            "right": Object {
              "args": Array [
                Object {
                  "tag": "PgCast",
                  "type": Object {
                    "dimensions": 1,
                    "tag": "TypeArray",
                    "value": Object {
                      "param": undefined,
                      "tag": "Type",
                      "value": "int",
                    },
                  },
                  "value": Object {
                    "tag": "Parameter",
                    "type": "native",
                    "value": "ids",
                  },
                },
              ],
              "tag": "Function",
              "value": Object {
                "tag": "Identifier",
                "value": "ANY",
              },
            },
            "tag": "BinaryExpression",
          },
          "tag": "BinaryExpression",
        },
        "tag": "BinaryExpression",
      },
    },
    Object {
      "tag": "GroupBy",
      "values": Array [
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "accounts",
            },
            Object {
              "tag": "Identifier",
              "value": "id",
            },
          ],
        },
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "accounts",
            },
            Object {
              "tag": "Identifier",
              "value": "start_on",
            },
          ],
        },
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "contacts",
            },
            Object {
              "tag": "Identifier",
              "value": "first_name",
            },
          ],
        },
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "contacts",
            },
            Object {
              "tag": "Identifier",
              "value": "last_name",
            },
          ],
        },
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "contacts",
            },
            Object {
              "tag": "Identifier",
              "value": "email",
            },
          ],
        },
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "installation_addresses",
            },
            Object {
              "tag": "Identifier",
              "value": "address_line_1",
            },
          ],
        },
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "installation_addresses",
            },
            Object {
              "tag": "Identifier",
              "value": "address_line_2",
            },
          ],
        },
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "installation_addresses",
            },
            Object {
              "tag": "Identifier",
              "value": "city",
            },
          ],
        },
        Object {
          "tag": "QualifiedIdentifier",
          "values": Array [
            Object {
              "tag": "Identifier",
              "value": "installation_addresses",
            },
            Object {
              "tag": "Identifier",
              "value": "postcode",
            },
          ],
        },
      ],
    },
    Object {
      "tag": "Limit",
      "value": Object {
        "tag": "Count",
        "value": Object {
          "tag": "PgCast",
          "type": Object {
            "param": undefined,
            "tag": "Type",
            "value": "int",
          },
          "value": Object {
            "tag": "Parameter",
            "type": "native",
            "value": "limit",
          },
        },
      },
    },
    Object {
      "tag": "Offset",
      "value": Object {
        "tag": "Count",
        "value": Object {
          "tag": "PgCast",
          "type": Object {
            "param": undefined,
            "tag": "Type",
            "value": "int",
          },
          "value": Object {
            "tag": "Parameter",
            "type": "native",
            "value": "offset",
          },
        },
      },
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql accounts.sql: accounts.sql 1`] = `
Object {
  "tag": "Insert",
  "values": Array [
    Object {
      "as": undefined,
      "tag": "Table",
      "value": Object {
        "tag": "QualifiedIdentifier",
        "values": Array [
          Object {
            "tag": "Identifier",
            "value": "accounts",
          },
        ],
      },
    },
    Object {
      "tag": "Columns",
      "values": Array [
        Object {
          "tag": "Identifier",
          "value": "source_system_id",
        },
        Object {
          "tag": "Identifier",
          "value": "customer_id",
        },
        Object {
          "tag": "Identifier",
          "value": "state",
        },
        Object {
          "tag": "Identifier",
          "value": "beneficiary_name",
        },
        Object {
          "tag": "Identifier",
          "value": "beneficiary_sort_code",
        },
        Object {
          "tag": "Identifier",
          "value": "beneficiary_account_number",
        },
        Object {
          "tag": "Identifier",
          "value": "payment_plan",
        },
        Object {
          "tag": "Identifier",
          "value": "start_on",
        },
        Object {
          "tag": "Identifier",
          "value": "end_on",
        },
        Object {
          "tag": "Identifier",
          "value": "created_at",
        },
        Object {
          "tag": "Identifier",
          "value": "updated_at",
        },
      ],
    },
    Object {
      "tag": "Select",
      "values": Array [
        Object {
          "tag": "SelectList",
          "values": Array [
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "source_system_id",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "ca",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "CustomerAccountId",
                  },
                ],
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "customer_id",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": undefined,
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "customers",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ca",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "CustomerId",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "customers",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "source_system_id",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                ],
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "state",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "PgCast",
                "type": Object {
                  "param": undefined,
                  "tag": "Type",
                  "value": "account_state",
                },
                "value": Object {
                  "tag": "Case",
                  "values": Array [
                    Object {
                      "condition": Object {
                        "left": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "ca",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "IsActive",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "=",
                          },
                          "right": Object {
                            "tag": "Boolean",
                            "value": "TRUE",
                          },
                          "tag": "BinaryExpression",
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "AND",
                        },
                        "right": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fa",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "IsAccountInDispute",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "=",
                          },
                          "right": Object {
                            "tag": "Boolean",
                            "value": "TRUE",
                          },
                          "tag": "BinaryExpression",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Dispute",
                      },
                    },
                    Object {
                      "condition": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "ca",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "IsActive",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "Boolean",
                          "value": "TRUE",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Active",
                      },
                    },
                    Object {
                      "tag": "Else",
                      "value": Object {
                        "tag": "String",
                        "value": "Closed",
                      },
                    },
                  ],
                },
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "beneficiary_name",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "ba",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "BankAccountName",
                  },
                ],
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "beneficiary_sort_code",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "ba",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "BankSortCode",
                  },
                ],
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "beneficiary_account_number",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "ba",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "BankAccountNo",
                  },
                ],
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "payment_plan",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Case",
                "values": Array [
                  Object {
                    "condition": Object {
                      "left": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "c",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "PaymentType",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "IS",
                        },
                        "right": Object {
                          "operator": Object {
                            "tag": "Operator",
                            "value": "NOT",
                          },
                          "tag": "UnaryExpression",
                          "value": Object {
                            "tag": "Null",
                          },
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "AND",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "c",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "PaymentType",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "<>",
                        },
                        "right": Object {
                          "tag": "String",
                          "value": "",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                    "tag": "When",
                    "value": Object {
                      "tag": "PgCast",
                      "type": Object {
                        "param": undefined,
                        "tag": "Type",
                        "value": "account_payment_plans",
                      },
                      "value": Object {
                        "args": Array [
                          Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "c",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "PaymentType",
                              },
                            ],
                          },
                        ],
                        "tag": "Function",
                        "value": Object {
                          "tag": "Identifier",
                          "value": "TRIM",
                        },
                      },
                    },
                  },
                  Object {
                    "tag": "Else",
                    "value": Object {
                      "tag": "Null",
                    },
                  },
                ],
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "start_on",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "args": Array [
                  Object {
                    "tag": "Select",
                    "values": Array [
                      Object {
                        "tag": "SelectList",
                        "values": Array [
                          Object {
                            "as": undefined,
                            "tag": "SelectListItem",
                            "value": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "DateOfReading",
                                },
                              ],
                            },
                          },
                        ],
                      },
                      Object {
                        "join": Array [],
                        "list": Object {
                          "tag": "FromList",
                          "values": Array [
                            Object {
                              "as": Object {
                                "tag": "As",
                                "value": Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                              },
                              "tag": "FromListItem",
                              "value": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "fit",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterReading",
                                  },
                                ],
                              },
                            },
                          ],
                        },
                        "tag": "From",
                      },
                      Object {
                        "tag": "Where",
                        "value": Object {
                          "left": Object {
                            "left": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "MeterId",
                                },
                              ],
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "=",
                            },
                            "right": Object {
                              "args": Array [
                                Object {
                                  "args": Array [
                                    Object {
                                      "tag": "QualifiedIdentifier",
                                      "values": Array [
                                        Object {
                                          "tag": "Identifier",
                                          "value": "im",
                                        },
                                        Object {
                                          "tag": "Identifier",
                                          "value": "MeterId",
                                        },
                                      ],
                                    },
                                  ],
                                  "tag": "Function",
                                  "value": Object {
                                    "tag": "Identifier",
                                    "value": "ARRAY_AGG",
                                  },
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "ANY",
                              },
                            },
                            "tag": "BinaryExpression",
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "AND",
                          },
                          "right": Object {
                            "left": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "ReadType",
                                },
                              ],
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "=",
                            },
                            "right": Object {
                              "args": Array [
                                Object {
                                  "tag": "ArrayConstructor",
                                  "values": Array [
                                    Object {
                                      "tag": "String",
                                      "value": "opening",
                                    },
                                    Object {
                                      "tag": "String",
                                      "value": "Opening",
                                    },
                                  ],
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "ANY",
                              },
                            },
                            "tag": "BinaryExpression",
                          },
                          "tag": "BinaryExpression",
                        },
                      },
                      Object {
                        "tag": "OrderBy",
                        "values": Array [
                          Object {
                            "direction": Object {
                              "tag": "OrderDirection",
                              "value": "ASC",
                            },
                            "tag": "OrderByItem",
                            "value": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "DateOfReading",
                                },
                              ],
                            },
                          },
                        ],
                      },
                      Object {
                        "tag": "Limit",
                        "value": Object {
                          "tag": "Count",
                          "value": "1",
                        },
                      },
                    ],
                  },
                  Object {
                    "tag": "Select",
                    "values": Array [
                      Object {
                        "tag": "SelectList",
                        "values": Array [
                          Object {
                            "as": undefined,
                            "tag": "SelectListItem",
                            "value": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "DateOfReading",
                                },
                              ],
                            },
                          },
                        ],
                      },
                      Object {
                        "join": Array [],
                        "list": Object {
                          "tag": "FromList",
                          "values": Array [
                            Object {
                              "as": Object {
                                "tag": "As",
                                "value": Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                              },
                              "tag": "FromListItem",
                              "value": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "fit",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterReading",
                                  },
                                ],
                              },
                            },
                          ],
                        },
                        "tag": "From",
                      },
                      Object {
                        "tag": "Where",
                        "value": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "mr",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "MeterId",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "=",
                          },
                          "right": Object {
                            "args": Array [
                              Object {
                                "args": Array [
                                  Object {
                                    "tag": "QualifiedIdentifier",
                                    "values": Array [
                                      Object {
                                        "tag": "Identifier",
                                        "value": "im",
                                      },
                                      Object {
                                        "tag": "Identifier",
                                        "value": "MeterId",
                                      },
                                    ],
                                  },
                                ],
                                "tag": "Function",
                                "value": Object {
                                  "tag": "Identifier",
                                  "value": "ARRAY_AGG",
                                },
                              },
                            ],
                            "tag": "Function",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "ANY",
                            },
                          },
                          "tag": "BinaryExpression",
                        },
                      },
                      Object {
                        "tag": "OrderBy",
                        "values": Array [
                          Object {
                            "direction": Object {
                              "tag": "OrderDirection",
                              "value": "ASC",
                            },
                            "tag": "OrderByItem",
                            "value": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "DateOfReading",
                                },
                              ],
                            },
                          },
                        ],
                      },
                      Object {
                        "tag": "Limit",
                        "value": Object {
                          "tag": "Count",
                          "value": "1",
                        },
                      },
                    ],
                  },
                ],
                "tag": "Function",
                "value": Object {
                  "tag": "Identifier",
                  "value": "COALESCE",
                },
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "end_on",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "args": Array [
                  Object {
                    "tag": "Select",
                    "values": Array [
                      Object {
                        "tag": "SelectList",
                        "values": Array [
                          Object {
                            "as": undefined,
                            "tag": "SelectListItem",
                            "value": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "DateOfReading",
                                },
                              ],
                            },
                          },
                        ],
                      },
                      Object {
                        "join": Array [],
                        "list": Object {
                          "tag": "FromList",
                          "values": Array [
                            Object {
                              "as": Object {
                                "tag": "As",
                                "value": Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                              },
                              "tag": "FromListItem",
                              "value": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "fit",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterReading",
                                  },
                                ],
                              },
                            },
                          ],
                        },
                        "tag": "From",
                      },
                      Object {
                        "tag": "Where",
                        "value": Object {
                          "left": Object {
                            "left": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "MeterId",
                                },
                              ],
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "=",
                            },
                            "right": Object {
                              "args": Array [
                                Object {
                                  "args": Array [
                                    Object {
                                      "tag": "QualifiedIdentifier",
                                      "values": Array [
                                        Object {
                                          "tag": "Identifier",
                                          "value": "im",
                                        },
                                        Object {
                                          "tag": "Identifier",
                                          "value": "MeterId",
                                        },
                                      ],
                                    },
                                  ],
                                  "tag": "Function",
                                  "value": Object {
                                    "tag": "Identifier",
                                    "value": "ARRAY_AGG",
                                  },
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "ANY",
                              },
                            },
                            "tag": "BinaryExpression",
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "AND",
                          },
                          "right": Object {
                            "left": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "ReadType",
                                },
                              ],
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "=",
                            },
                            "right": Object {
                              "args": Array [
                                Object {
                                  "tag": "ArrayConstructor",
                                  "values": Array [
                                    Object {
                                      "tag": "String",
                                      "value": "Closure",
                                    },
                                    Object {
                                      "tag": "String",
                                      "value": "Closing",
                                    },
                                    Object {
                                      "tag": "String",
                                      "value": "Clsoing",
                                    },
                                    Object {
                                      "tag": "String",
                                      "value": "Final",
                                    },
                                  ],
                                },
                              ],
                              "tag": "Function",
                              "value": Object {
                                "tag": "Identifier",
                                "value": "ANY",
                              },
                            },
                            "tag": "BinaryExpression",
                          },
                          "tag": "BinaryExpression",
                        },
                      },
                      Object {
                        "tag": "OrderBy",
                        "values": Array [
                          Object {
                            "direction": Object {
                              "tag": "OrderDirection",
                              "value": "DESC",
                            },
                            "tag": "OrderByItem",
                            "value": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mr",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "DateOfReading",
                                },
                              ],
                            },
                          },
                        ],
                      },
                      Object {
                        "tag": "Limit",
                        "value": Object {
                          "tag": "Count",
                          "value": "1",
                        },
                      },
                    ],
                  },
                  Object {
                    "expression": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ca",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "IsActive",
                        },
                      ],
                    },
                    "tag": "Case",
                    "values": Array [
                      Object {
                        "condition": Object {
                          "tag": "Boolean",
                          "value": "FALSE",
                        },
                        "tag": "When",
                        "value": Object {
                          "tag": "Select",
                          "values": Array [
                            Object {
                              "tag": "SelectList",
                              "values": Array [
                                Object {
                                  "as": undefined,
                                  "tag": "SelectListItem",
                                  "value": Object {
                                    "tag": "QualifiedIdentifier",
                                    "values": Array [
                                      Object {
                                        "tag": "Identifier",
                                        "value": "mr",
                                      },
                                      Object {
                                        "tag": "Identifier",
                                        "value": "DateOfReading",
                                      },
                                    ],
                                  },
                                },
                              ],
                            },
                            Object {
                              "join": Array [],
                              "list": Object {
                                "tag": "FromList",
                                "values": Array [
                                  Object {
                                    "as": Object {
                                      "tag": "As",
                                      "value": Object {
                                        "tag": "Identifier",
                                        "value": "mr",
                                      },
                                    },
                                    "tag": "FromListItem",
                                    "value": Object {
                                      "tag": "QualifiedIdentifier",
                                      "values": Array [
                                        Object {
                                          "tag": "Identifier",
                                          "value": "fit",
                                        },
                                        Object {
                                          "tag": "Identifier",
                                          "value": "MeterReading",
                                        },
                                      ],
                                    },
                                  },
                                ],
                              },
                              "tag": "From",
                            },
                            Object {
                              "tag": "Where",
                              "value": Object {
                                "left": Object {
                                  "tag": "QualifiedIdentifier",
                                  "values": Array [
                                    Object {
                                      "tag": "Identifier",
                                      "value": "mr",
                                    },
                                    Object {
                                      "tag": "Identifier",
                                      "value": "MeterId",
                                    },
                                  ],
                                },
                                "operator": Object {
                                  "tag": "Operator",
                                  "value": "=",
                                },
                                "right": Object {
                                  "args": Array [
                                    Object {
                                      "args": Array [
                                        Object {
                                          "tag": "QualifiedIdentifier",
                                          "values": Array [
                                            Object {
                                              "tag": "Identifier",
                                              "value": "im",
                                            },
                                            Object {
                                              "tag": "Identifier",
                                              "value": "MeterId",
                                            },
                                          ],
                                        },
                                      ],
                                      "tag": "Function",
                                      "value": Object {
                                        "tag": "Identifier",
                                        "value": "ARRAY_AGG",
                                      },
                                    },
                                  ],
                                  "tag": "Function",
                                  "value": Object {
                                    "tag": "Identifier",
                                    "value": "ANY",
                                  },
                                },
                                "tag": "BinaryExpression",
                              },
                            },
                            Object {
                              "tag": "OrderBy",
                              "values": Array [
                                Object {
                                  "direction": Object {
                                    "tag": "OrderDirection",
                                    "value": "DESC",
                                  },
                                  "tag": "OrderByItem",
                                  "value": Object {
                                    "tag": "QualifiedIdentifier",
                                    "values": Array [
                                      Object {
                                        "tag": "Identifier",
                                        "value": "mr",
                                      },
                                      Object {
                                        "tag": "Identifier",
                                        "value": "DateOfReading",
                                      },
                                    ],
                                  },
                                },
                              ],
                            },
                            Object {
                              "tag": "Limit",
                              "value": Object {
                                "tag": "Count",
                                "value": "1",
                              },
                            },
                          ],
                        },
                      },
                      Object {
                        "tag": "Else",
                        "value": Object {
                          "tag": "Null",
                        },
                      },
                    ],
                  },
                ],
                "tag": "Function",
                "value": Object {
                  "tag": "Identifier",
                  "value": "COALESCE",
                },
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "created_at",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "ca",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateInserted",
                  },
                ],
              },
            },
            Object {
              "as": Object {
                "tag": "As",
                "value": Object {
                  "tag": "Identifier",
                  "value": "updated_at",
                },
              },
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "ca",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateUpdated",
                  },
                ],
              },
            },
          ],
        },
        Object {
          "join": Array [
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "Customer",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": "LEFT",
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "c",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ca",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "CustomerId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "c",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "CustomerId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "FiTAccount",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": "LEFT",
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "fa",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "fa",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "FiTAccountId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ca",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "FitAccountId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "GenerationAccount",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": "LEFT",
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "ga",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ga",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "FitAccountId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ca",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "FitAccountId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "GenerationAccountInstallation",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": "LEFT",
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "gai",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "gai",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "GenerationAccountId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ga",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "GenerationAccountId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "InstallationMeter",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": "LEFT",
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "im",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "im",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "InstallationId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "gai",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "InstallationId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "BankAccount",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": "LEFT",
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "ba",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ba",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "GenerationAccountId",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ga",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "GenerationAccountId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "AND",
                    },
                    "right": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ba",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "IsActive",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "Boolean",
                        "value": "TRUE",
                      },
                      "tag": "BinaryExpression",
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
          ],
          "list": Object {
            "tag": "FromList",
            "values": Array [
              Object {
                "as": Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "ca",
                  },
                },
                "tag": "FromListItem",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "fit",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "CustomerAccount",
                    },
                  ],
                },
              },
            ],
          },
          "tag": "From",
        },
        Object {
          "tag": "Where",
          "value": Object {
            "left": Object {
              "left": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "ca",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "CustomerRoleValue",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "&",
                },
                "right": Object {
                  "tag": "Number",
                  "value": "1",
                },
                "tag": "BinaryExpression",
              },
              "operator": Object {
                "tag": "Operator",
                "value": ">",
              },
              "right": Object {
                "tag": "Number",
                "value": "0",
              },
              "tag": "BinaryExpression",
            },
            "operator": Object {
              "tag": "Operator",
              "value": "OR",
            },
            "right": Object {
              "left": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "ca",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "FitAccountId",
                  },
                ],
              },
              "operator": Object {
                "tag": "Operator",
                "value": "=",
              },
              "right": Object {
                "tag": "Number",
                "value": "422",
              },
              "tag": "BinaryExpression",
            },
            "tag": "BinaryExpression",
          },
        },
        Object {
          "tag": "GroupBy",
          "values": Array [
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "ca",
                },
                Object {
                  "tag": "Identifier",
                  "value": "CustomerAccountId",
                },
              ],
            },
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "ca",
                },
                Object {
                  "tag": "Identifier",
                  "value": "IsActive",
                },
              ],
            },
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "fa",
                },
                Object {
                  "tag": "Identifier",
                  "value": "IsAccountInDispute",
                },
              ],
            },
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "ba",
                },
                Object {
                  "tag": "Identifier",
                  "value": "BankAccountName",
                },
              ],
            },
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "ba",
                },
                Object {
                  "tag": "Identifier",
                  "value": "BankSortCode",
                },
              ],
            },
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "ba",
                },
                Object {
                  "tag": "Identifier",
                  "value": "BankAccountNo",
                },
              ],
            },
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "c",
                },
                Object {
                  "tag": "Identifier",
                  "value": "PaymentType",
                },
              ],
            },
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "ca",
                },
                Object {
                  "tag": "Identifier",
                  "value": "DateInserted",
                },
              ],
            },
            Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "ca",
                },
                Object {
                  "tag": "Identifier",
                  "value": "DateUpdated",
                },
              ],
            },
          ],
        },
      ],
    },
    Object {
      "tag": "Conflict",
      "values": Array [
        Object {
          "tag": "ConflictTarget",
          "values": Array [
            Object {
              "as": undefined,
              "tag": "Table",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "source_system_id",
                  },
                ],
              },
            },
            Object {
              "tag": "Where",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "source_system_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "IS",
                },
                "right": Object {
                  "operator": Object {
                    "tag": "Operator",
                    "value": "NOT",
                  },
                  "tag": "UnaryExpression",
                  "value": Object {
                    "tag": "Null",
                  },
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "tag": "DoUpdate",
          "value": Object {
            "tag": "Set",
            "value": Object {
              "tag": "SetList",
              "values": Array [
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "customer_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "customer_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "start_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "start_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "end_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "end_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "state",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "state",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "beneficiary_name",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "beneficiary_name",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "beneficiary_sort_code",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "beneficiary_sort_code",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "beneficiary_account_number",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "beneficiary_account_number",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "payment_plan",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "payment_plan",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                },
              ],
            },
          },
          "where": undefined,
        },
      ],
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql bacs.query.sql: bacs.query.sql 1`] = `
Object {
  "tag": "Select",
  "values": Array [
    Object {
      "tag": "SelectList",
      "values": Array [
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "fitId",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "p",
              },
              Object {
                "tag": "Identifier",
                "value": "fit_reference",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "name",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "a",
              },
              Object {
                "tag": "Identifier",
                "value": "beneficiary_name",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "amount",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "p",
              },
              Object {
                "tag": "Identifier",
                "value": "amount",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "quarter",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "p",
              },
              Object {
                "tag": "Identifier",
                "value": "levelisation_reference",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "bankDetails",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "args": Array [
              Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "a",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "beneficiary_sort_code",
                  },
                ],
              },
              Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "a",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "beneficiary_account_number",
                  },
                ],
              },
            ],
            "tag": "Function",
            "value": Object {
              "tag": "Identifier",
              "value": "CONCAT",
            },
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "addressLine1",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "a2",
              },
              Object {
                "tag": "Identifier",
                "value": "address_line_1",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "addressLine2",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "a2",
              },
              Object {
                "tag": "Identifier",
                "value": "address_line_2",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "addressLine3",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "a2",
              },
              Object {
                "tag": "Identifier",
                "value": "address_line_3",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "postcode",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "a2",
              },
              Object {
                "tag": "Identifier",
                "value": "postcode",
              },
            ],
          },
        },
      ],
    },
    Object {
      "join": Array [
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "accounts",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "a",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "a",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "p",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "account_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "customers",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "c2",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "c2",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "a",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "customer_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contacts",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "c3",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "c3",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "c2",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "primary_contact_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "addresses",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "a2",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "a2",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "c3",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "address_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
      ],
      "list": Object {
        "tag": "FromList",
        "values": Array [
          Object {
            "as": Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "p",
              },
            },
            "tag": "FromListItem",
            "value": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "payments",
                },
              ],
            },
          },
        ],
      },
      "tag": "From",
    },
    Object {
      "tag": "Where",
      "value": Object {
        "left": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "a",
              },
              Object {
                "tag": "Identifier",
                "value": "payment_plan",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "=",
          },
          "right": Object {
            "tag": "String",
            "value": "BACS",
          },
          "tag": "BinaryExpression",
        },
        "operator": Object {
          "tag": "Operator",
          "value": "AND",
        },
        "right": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "p",
              },
              Object {
                "tag": "Identifier",
                "value": "levelisation_reference",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "=",
          },
          "right": Object {
            "tag": "Parameter",
            "type": "native",
            "value": "quarter",
          },
          "tag": "BinaryExpression",
        },
        "tag": "BinaryExpression",
      },
    },
    Object {
      "tag": "Limit",
      "value": Object {
        "tag": "Count",
        "value": Object {
          "tag": "Parameter",
          "type": "native",
          "value": "perPage",
        },
      },
    },
    Object {
      "tag": "Offset",
      "value": Object {
        "tag": "Count",
        "value": Object {
          "tag": "Parameter",
          "type": "native",
          "value": "offset",
        },
      },
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql contracts.sql: contracts.sql 1`] = `
Object {
  "tag": "Insert",
  "values": Array [
    Object {
      "as": undefined,
      "tag": "Table",
      "value": Object {
        "tag": "QualifiedIdentifier",
        "values": Array [
          Object {
            "tag": "Identifier",
            "value": "contracts",
          },
        ],
      },
    },
    Object {
      "tag": "Columns",
      "values": Array [
        Object {
          "tag": "Identifier",
          "value": "source_system_id",
        },
        Object {
          "tag": "Identifier",
          "value": "account_id",
        },
        Object {
          "tag": "Identifier",
          "value": "contact_id",
        },
        Object {
          "tag": "Identifier",
          "value": "installation_id",
        },
        Object {
          "tag": "Identifier",
          "value": "generation_tariff_id",
        },
        Object {
          "tag": "Identifier",
          "value": "export_tariff_id",
        },
        Object {
          "tag": "Identifier",
          "value": "generation_percentage_split",
        },
        Object {
          "tag": "Identifier",
          "value": "export_percentage_split",
        },
        Object {
          "tag": "Identifier",
          "value": "scheme_type",
        },
        Object {
          "tag": "Identifier",
          "value": "scheme_account_reference",
        },
        Object {
          "tag": "Identifier",
          "value": "confirmation_on",
        },
        Object {
          "tag": "Identifier",
          "value": "terms_and_conditions_agreed",
        },
        Object {
          "tag": "Identifier",
          "value": "created_at",
        },
        Object {
          "tag": "Identifier",
          "value": "updated_at",
        },
      ],
    },
    Object {
      "tag": "Select",
      "values": Array [
        Object {
          "tag": "SelectList",
          "values": Array [
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "gai",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "GenerationAccountInstallationId",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "accounts",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": undefined,
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "accounts",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "accounts",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "source_system_id",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ca",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "CustomerAccountId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "contacts",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": undefined,
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "contacts",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "contacts",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "source_system_id",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ca",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "CustomerId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "installations",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": undefined,
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "installations",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "installations",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "source_system_id",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "gai",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "InstallationId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "tariffs",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "fit",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "Meter",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "m",
                            },
                          },
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "im",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterId",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "fit",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "MeterType",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "mt",
                            },
                          },
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterTypeId",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "mt",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterTypeId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "tariffs",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "tariffs",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "source_system_id",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "TariffId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                    ],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "InstallationMeter",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "i",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "InstallationId",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "InstallationId",
                            },
                          ],
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "AND",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "mt",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "MeterTypeTitle",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "String",
                          "value": "Generation",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "Limit",
                    "value": Object {
                      "tag": "Count",
                      "value": "1",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "tariffs",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": undefined,
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "tariffs",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "tariffs",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "source_system_id",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "Case",
                        "values": Array [
                          Object {
                            "condition": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "i",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "EligibilityDate",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "<",
                              },
                              "right": Object {
                                "tag": "String",
                                "value": "2012-08-01",
                              },
                              "tag": "BinaryExpression",
                            },
                            "tag": "When",
                            "value": Object {
                              "tag": "Number",
                              "value": "100001",
                            },
                          },
                          Object {
                            "tag": "Else",
                            "value": Object {
                              "tag": "Number",
                              "value": "100002",
                            },
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "PercentageSplit",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "fit",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "Meter",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "m",
                            },
                          },
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "im",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterId",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "fit",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "MeterType",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "mt",
                            },
                          },
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterTypeId",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "mt",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterTypeId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                    ],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "InstallationMeter",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "left": Object {
                          "left": Object {
                            "left": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "i",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "InstallationId",
                                },
                              ],
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "=",
                            },
                            "right": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "im",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "InstallationId",
                                },
                              ],
                            },
                            "tag": "BinaryExpression",
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "AND",
                          },
                          "right": Object {
                            "left": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mt",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "MeterTypeTitle",
                                },
                              ],
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "=",
                            },
                            "right": Object {
                              "tag": "String",
                              "value": "Generation",
                            },
                            "tag": "BinaryExpression",
                          },
                          "tag": "BinaryExpression",
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "AND",
                        },
                        "right": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "im",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "PercentageSplit",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "IS",
                          },
                          "right": Object {
                            "operator": Object {
                              "tag": "Operator",
                              "value": "NOT",
                            },
                            "tag": "UnaryExpression",
                            "value": Object {
                              "tag": "Null",
                            },
                          },
                          "tag": "BinaryExpression",
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "AND",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "PercentageSplit",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "<>",
                        },
                        "right": Object {
                          "tag": "Number",
                          "value": "100",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "Limit",
                    "value": Object {
                      "tag": "Count",
                      "value": "1",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "PercentageSplit",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "fit",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "Meter",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "m",
                            },
                          },
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "im",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterId",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "fit",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "MeterType",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "mt",
                            },
                          },
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterTypeId",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "mt",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterTypeId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                    ],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "InstallationMeter",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "left": Object {
                          "left": Object {
                            "left": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "i",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "InstallationId",
                                },
                              ],
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "=",
                            },
                            "right": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "im",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "InstallationId",
                                },
                              ],
                            },
                            "tag": "BinaryExpression",
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "AND",
                          },
                          "right": Object {
                            "left": Object {
                              "tag": "QualifiedIdentifier",
                              "values": Array [
                                Object {
                                  "tag": "Identifier",
                                  "value": "mt",
                                },
                                Object {
                                  "tag": "Identifier",
                                  "value": "MeterTypeTitle",
                                },
                              ],
                            },
                            "operator": Object {
                              "tag": "Operator",
                              "value": "=",
                            },
                            "right": Object {
                              "tag": "String",
                              "value": "Export",
                            },
                            "tag": "BinaryExpression",
                          },
                          "tag": "BinaryExpression",
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "AND",
                        },
                        "right": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "im",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "PercentageSplit",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "IS",
                          },
                          "right": Object {
                            "operator": Object {
                              "tag": "Operator",
                              "value": "NOT",
                            },
                            "tag": "UnaryExpression",
                            "value": Object {
                              "tag": "Null",
                            },
                          },
                          "tag": "BinaryExpression",
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "AND",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "PercentageSplit",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "<>",
                        },
                        "right": Object {
                          "tag": "Number",
                          "value": "100",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "Limit",
                    "value": Object {
                      "tag": "Count",
                      "value": "1",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "PgCast",
                "type": Object {
                  "param": undefined,
                  "tag": "Type",
                  "value": "contract_scheme_types",
                },
                "value": Object {
                  "tag": "Case",
                  "values": Array [
                    Object {
                      "condition": Object {
                        "left": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "i",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "SEGId",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "IS",
                          },
                          "right": Object {
                            "operator": Object {
                              "tag": "Operator",
                              "value": "NOT",
                            },
                            "tag": "UnaryExpression",
                            "value": Object {
                              "tag": "Null",
                            },
                          },
                          "tag": "BinaryExpression",
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "AND",
                        },
                        "right": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "i",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "CFRFiTId",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "IS",
                          },
                          "right": Object {
                            "tag": "Null",
                          },
                          "tag": "BinaryExpression",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "SEG",
                      },
                    },
                    Object {
                      "tag": "Else",
                      "value": Object {
                        "tag": "String",
                        "value": "FIT",
                      },
                    },
                  ],
                },
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "args": Array [
                  Object {
                    "args": Array [
                      Object {
                        "args": Array [
                          Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "i",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "CFRFiTId",
                              },
                            ],
                          },
                        ],
                        "tag": "Function",
                        "value": Object {
                          "tag": "Identifier",
                          "value": "UPPER",
                        },
                      },
                      Object {
                        "tag": "String",
                        "value": "(FIT\\\\\\\\d+)",
                      },
                    ],
                    "tag": "Function",
                    "value": Object {
                      "tag": "Identifier",
                      "value": "SUBSTRING",
                    },
                  },
                  Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "i",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "SEGId",
                      },
                    ],
                  },
                  Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "i",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "CFRFiTId",
                      },
                    ],
                  },
                ],
                "tag": "Function",
                "value": Object {
                  "tag": "Identifier",
                  "value": "COALESCE",
                },
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "ConfirmationDate",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Boolean",
                "value": "TRUE",
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "gai",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateInserted",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "gai",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateUpdated",
                  },
                ],
              },
            },
          ],
        },
        Object {
          "join": Array [
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "GenerationAccount",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "ga",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "gai",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "GenerationAccountId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ga",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "GenerationAccountId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "Installation",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "gai",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "InstallationId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "i",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "InstallationId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "CustomerAccount",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "ca",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ca",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "FitAccountId",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ga",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "FitAccountId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "AND",
                    },
                    "right": Object {
                      "left": Object {
                        "left": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "ca",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "CustomerRoleValue",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "&",
                          },
                          "right": Object {
                            "tag": "Number",
                            "value": "1",
                          },
                          "tag": "BinaryExpression",
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": ">",
                        },
                        "right": Object {
                          "tag": "Number",
                          "value": "0",
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "OR",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "ca",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "FitAccountId",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "Number",
                          "value": "422",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
          ],
          "list": Object {
            "tag": "FromList",
            "values": Array [
              Object {
                "as": Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "gai",
                  },
                },
                "tag": "FromListItem",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "fit",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "GenerationAccountInstallation",
                    },
                  ],
                },
              },
            ],
          },
          "tag": "From",
        },
      ],
    },
    Object {
      "tag": "Conflict",
      "values": Array [
        Object {
          "tag": "ConflictTarget",
          "values": Array [
            Object {
              "as": undefined,
              "tag": "Table",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "source_system_id",
                  },
                ],
              },
            },
            Object {
              "tag": "Where",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "source_system_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "IS",
                },
                "right": Object {
                  "operator": Object {
                    "tag": "Operator",
                    "value": "NOT",
                  },
                  "tag": "UnaryExpression",
                  "value": Object {
                    "tag": "Null",
                  },
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "tag": "DoUpdate",
          "value": Object {
            "tag": "Set",
            "value": Object {
              "tag": "SetList",
              "values": Array [
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "account_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "account_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "contact_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "contact_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "installation_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "installation_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "generation_tariff_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "generation_tariff_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "export_tariff_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "export_tariff_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "scheme_type",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "scheme_type",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "scheme_account_reference",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "scheme_account_reference",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "confirmation_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "confirmation_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "terms_and_conditions_agreed",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "terms_and_conditions_agreed",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                },
              ],
            },
          },
          "where": undefined,
        },
      ],
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql generation-read-data.query.sql: generation-read-data.query.sql 1`] = `
Object {
  "tag": "Select",
  "values": Array [
    Object {
      "tag": "SelectList",
      "values": Array [
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "dateOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "meter_reads",
              },
              Object {
                "tag": "Identifier",
                "value": "date_on",
              },
            ],
          },
        },
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "meter_reads",
              },
              Object {
                "tag": "Identifier",
                "value": "value",
              },
            ],
          },
        },
      ],
    },
    Object {
      "join": Array [
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "installation_meters",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": undefined,
          },
          "values": Array [
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "meter_reads",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "meter_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "installation_meters",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "meter_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
      ],
      "list": Object {
        "tag": "FromList",
        "values": Array [
          Object {
            "as": undefined,
            "tag": "FromListItem",
            "value": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "meter_reads",
                },
              ],
            },
          },
        ],
      },
      "tag": "From",
    },
    Object {
      "tag": "Where",
      "value": Object {
        "left": Object {
          "left": Object {
            "left": Object {
              "left": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "installation_meters",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "installation_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "Parameter",
                  "type": "native",
                  "value": "installationId",
                },
                "tag": "BinaryExpression",
              },
              "operator": Object {
                "tag": "Operator",
                "value": "AND",
              },
              "right": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "installation_meters",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "meter_type",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "String",
                  "value": "Generation",
                },
                "tag": "BinaryExpression",
              },
              "tag": "BinaryExpression",
            },
            "operator": Object {
              "tag": "Operator",
              "value": "AND",
            },
            "right": Object {
              "left": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "meter_reads",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "deleted_at",
                  },
                ],
              },
              "operator": Object {
                "tag": "Operator",
                "value": "IS",
              },
              "right": Object {
                "tag": "Null",
              },
              "tag": "BinaryExpression",
            },
            "tag": "BinaryExpression",
          },
          "operator": Object {
            "tag": "Operator",
            "value": "AND",
          },
          "right": Object {
            "left": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "meter_reads",
                },
                Object {
                  "tag": "Identifier",
                  "value": "type",
                },
              ],
            },
            "operator": Object {
              "tag": "Operator",
              "value": "<>",
            },
            "right": Object {
              "tag": "String",
              "value": "Meter Verification",
            },
            "tag": "BinaryExpression",
          },
          "tag": "BinaryExpression",
        },
        "operator": Object {
          "tag": "Operator",
          "value": "AND",
        },
        "right": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "meter_reads",
              },
              Object {
                "tag": "Identifier",
                "value": "is_accepted",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "=",
          },
          "right": Object {
            "tag": "Boolean",
            "value": "true",
          },
          "tag": "BinaryExpression",
        },
        "tag": "BinaryExpression",
      },
    },
    Object {
      "tag": "OrderBy",
      "values": Array [
        Object {
          "direction": Object {
            "tag": "OrderDirection",
            "value": "ASC",
          },
          "tag": "OrderByItem",
          "value": Object {
            "args": Array [
              Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "meter_reads",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "date_on",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "-",
                },
                "right": Object {
                  "tag": "PgCast",
                  "type": Object {
                    "param": undefined,
                    "tag": "Type",
                    "value": "date",
                  },
                  "value": Object {
                    "tag": "Parameter",
                    "type": "native",
                    "value": "exportDateOn",
                  },
                },
                "tag": "BinaryExpression",
              },
            ],
            "tag": "Function",
            "value": Object {
              "tag": "Identifier",
              "value": "ABS",
            },
          },
        },
      ],
    },
    Object {
      "tag": "Limit",
      "value": Object {
        "tag": "Count",
        "value": "1",
      },
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql installation-meter-update.query.sql: installation-meter-update.query.sql 1`] = `
Object {
  "tag": "Update",
  "values": Array [
    Object {
      "as": undefined,
      "tag": "Table",
      "value": Object {
        "tag": "QualifiedIdentifier",
        "values": Array [
          Object {
            "tag": "Identifier",
            "value": "installation_meters",
          },
        ],
      },
    },
    Object {
      "tag": "Set",
      "value": Object {
        "tag": "SetList",
        "values": Array [
          Object {
            "column": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "end_on",
                },
              ],
            },
            "tag": "SetItem",
            "value": Object {
              "tag": "Parameter",
              "type": "native",
              "value": "removalDate",
            },
          },
        ],
      },
    },
    Object {
      "tag": "Where",
      "value": Object {
        "left": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "end_on",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "IS",
          },
          "right": Object {
            "tag": "Null",
          },
          "tag": "BinaryExpression",
        },
        "operator": Object {
          "tag": "Operator",
          "value": "AND",
        },
        "right": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "meter_id",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "=",
          },
          "right": Object {
            "tag": "Parameter",
            "type": "native",
            "value": "meterId",
          },
          "tag": "BinaryExpression",
        },
        "tag": "BinaryExpression",
      },
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql installations.sql: installations.sql 1`] = `
Object {
  "tag": "Insert",
  "values": Array [
    Object {
      "as": undefined,
      "tag": "Table",
      "value": Object {
        "tag": "QualifiedIdentifier",
        "values": Array [
          Object {
            "tag": "Identifier",
            "value": "installations",
          },
        ],
      },
    },
    Object {
      "tag": "Columns",
      "values": Array [
        Object {
          "tag": "Identifier",
          "value": "source_system_id",
        },
        Object {
          "tag": "Identifier",
          "value": "address_id",
        },
        Object {
          "tag": "Identifier",
          "value": "name",
        },
        Object {
          "tag": "Identifier",
          "value": "type",
        },
        Object {
          "tag": "Identifier",
          "value": "technology_type",
        },
        Object {
          "tag": "Identifier",
          "value": "property_type",
        },
        Object {
          "tag": "Identifier",
          "value": "export_type",
        },
        Object {
          "tag": "Identifier",
          "value": "commissioned_on",
        },
        Object {
          "tag": "Identifier",
          "value": "decommissioned_on",
        },
        Object {
          "tag": "Identifier",
          "value": "eligibility_start_on",
        },
        Object {
          "tag": "Identifier",
          "value": "eligibility_end_on",
        },
        Object {
          "tag": "Identifier",
          "value": "installed_on",
        },
        Object {
          "tag": "Identifier",
          "value": "verified_on",
        },
        Object {
          "tag": "Identifier",
          "value": "reverified_on",
        },
        Object {
          "tag": "Identifier",
          "value": "inspected_on",
        },
        Object {
          "tag": "Identifier",
          "value": "mcs_reference",
        },
        Object {
          "tag": "Identifier",
          "value": "tic_reference",
        },
        Object {
          "tag": "Identifier",
          "value": "dnc_reference",
        },
        Object {
          "tag": "Identifier",
          "value": "roofit_reference",
        },
        Object {
          "tag": "Identifier",
          "value": "name_of_grant",
        },
        Object {
          "tag": "Identifier",
          "value": "value_of_grant",
        },
        Object {
          "tag": "Identifier",
          "value": "date_grant_repaid",
        },
        Object {
          "tag": "Identifier",
          "value": "epc_rate",
        },
        Object {
          "tag": "Identifier",
          "value": "epc_date",
        },
        Object {
          "tag": "Identifier",
          "value": "epc_number",
        },
        Object {
          "tag": "Identifier",
          "value": "has_battery_storage",
        },
        Object {
          "tag": "Identifier",
          "value": "battery_installation_date_on",
        },
        Object {
          "tag": "Identifier",
          "value": "export_mpan",
        },
        Object {
          "tag": "Identifier",
          "value": "supply_mpan",
        },
        Object {
          "tag": "Identifier",
          "value": "switched_from",
        },
        Object {
          "tag": "Identifier",
          "value": "switched_to",
        },
        Object {
          "tag": "Identifier",
          "value": "switched_on",
        },
        Object {
          "tag": "Identifier",
          "value": "legacy_fit_db_id",
        },
        Object {
          "tag": "Identifier",
          "value": "created_at",
        },
        Object {
          "tag": "Identifier",
          "value": "updated_at",
        },
      ],
    },
    Object {
      "tag": "Select",
      "values": Array [
        Object {
          "tag": "SelectList",
          "values": Array [
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "InstallationId",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "addresses",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": undefined,
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "addresses",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "addresses",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "source_system_id",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "i",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "AddressId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "InstallationName",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "PgCast",
                "type": Object {
                  "param": undefined,
                  "tag": "Type",
                  "value": "installation_types",
                },
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "it",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "InstallationTypeTitle",
                    },
                  ],
                },
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "PgCast",
                "type": Object {
                  "param": undefined,
                  "tag": "Type",
                  "value": "installation_technology_types",
                },
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "gtt",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "GeneratorTechnologyTypeRef",
                    },
                  ],
                },
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "PgCast",
                "type": Object {
                  "param": undefined,
                  "tag": "Type",
                  "value": "installation_property_type",
                },
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "pt",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "PropertyTypeTitle",
                    },
                  ],
                },
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "PgCast",
                "type": Object {
                  "param": undefined,
                  "tag": "Type",
                  "value": "installation_export_type",
                },
                "value": Object {
                  "expression": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "i",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "ExportType",
                      },
                    ],
                  },
                  "tag": "Case",
                  "values": Array [
                    Object {
                      "condition": Object {
                        "tag": "Null",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "Null",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "SEG",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "Null",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Deemed",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Deemed",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Off_Grid",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Off Grid",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "PPA_OVO",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "PPA",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Metered_Standard_Tariff",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Metered Export",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "PPA_Other",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "PPA",
                      },
                    },
                  ],
                },
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "TariffDate",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DecommisionedDate",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "EligibilityDate",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "EligibilityEndDate",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateInstalled",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "ivi",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "DateVerified",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "ivi",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "InstallationVerificationInfo",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ivi",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "InstallationId",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "i",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "InstallationId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "OrderBy",
                    "values": Array [
                      Object {
                        "direction": Object {
                          "tag": "OrderDirection",
                          "value": "ASC",
                        },
                        "tag": "OrderByItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "ivi",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "DateVerified",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "tag": "Limit",
                    "value": Object {
                      "tag": "Count",
                      "value": "1",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "index": Object {
                            "tag": "Number",
                            "value": "1",
                          },
                          "tag": "ArrayIndex",
                          "value": Object {
                            "args": Array [
                              Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "DateVerified",
                                  },
                                ],
                              },
                              Object {
                                "tag": "OrderBy",
                                "values": Array [
                                  Object {
                                    "direction": Object {
                                      "tag": "OrderDirection",
                                      "value": "DESC",
                                    },
                                    "tag": "OrderByItem",
                                    "value": Object {
                                      "tag": "QualifiedIdentifier",
                                      "values": Array [
                                        Object {
                                          "tag": "Identifier",
                                          "value": "DateVerified",
                                        },
                                      ],
                                    },
                                  },
                                ],
                              },
                            ],
                            "tag": "Function",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "ARRAY_AGG",
                            },
                          },
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "ivi",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "InstallationVerificationInfo",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ivi",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "InstallationId",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "i",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "InstallationId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "GroupBy",
                    "values": Array [
                      Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "InstallationId",
                          },
                        ],
                      },
                    ],
                  },
                  Object {
                    "tag": "Having",
                    "value": Object {
                      "left": Object {
                        "args": Array [
                          Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "InstallationId",
                              },
                            ],
                          },
                        ],
                        "tag": "Function",
                        "value": Object {
                          "tag": "Identifier",
                          "value": "COUNT",
                        },
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": ">",
                      },
                      "right": Object {
                        "tag": "Number",
                        "value": "1",
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "ConfirmationDate",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "MCSInstallerCertificateNo",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "InstalledCapacity",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "InstalledCapacity",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "ROOFITNo",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "NameOfGrant",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "ValueOfGrant",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateGrantRepaid",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "EPCRate",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateInstalled",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Null",
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Null",
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Null",
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "m",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "MPAN",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "fit",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "Meter",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "m",
                            },
                          },
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterId",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "im",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                      Object {
                        "table": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "fit",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "MeterType",
                            },
                          ],
                        },
                        "tag": "Join",
                        "type": Object {
                          "tag": "JoinType",
                          "value": undefined,
                        },
                        "values": Array [
                          Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "mt",
                            },
                          },
                          Object {
                            "tag": "JoinOn",
                            "value": Object {
                              "left": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "m",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterTypeId",
                                  },
                                ],
                              },
                              "operator": Object {
                                "tag": "Operator",
                                "value": "=",
                              },
                              "right": Object {
                                "tag": "QualifiedIdentifier",
                                "values": Array [
                                  Object {
                                    "tag": "Identifier",
                                    "value": "mt",
                                  },
                                  Object {
                                    "tag": "Identifier",
                                    "value": "MeterTypeId",
                                  },
                                ],
                              },
                              "tag": "BinaryExpression",
                            },
                          },
                        ],
                      },
                    ],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "InstallationMeter",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "mt",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "MeterTypeTitle",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "String",
                          "value": "Export",
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "AND",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "im",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "InstallationId",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "i",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "InstallationId",
                            },
                          ],
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "Limit",
                    "value": Object {
                      "tag": "Count",
                      "value": "1",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "c",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "SupplyMPAN",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "Company",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "Switch",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "InstallationId",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "i",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "InstallationId",
                            },
                          ],
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "AND",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "IsSwitchIn",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "Boolean",
                          "value": "TRUE",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "OrderBy",
                    "values": Array [
                      Object {
                        "direction": Object {
                          "tag": "OrderDirection",
                          "value": "DESC",
                        },
                        "tag": "OrderByItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "DateInserted",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "tag": "Limit",
                    "value": Object {
                      "tag": "Count",
                      "value": "1",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "Company",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "Switch",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "InstallationId",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "i",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "InstallationId",
                            },
                          ],
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "AND",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "IsSwitchIn",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "Boolean",
                          "value": "FALSE",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "OrderBy",
                    "values": Array [
                      Object {
                        "direction": Object {
                          "tag": "OrderDirection",
                          "value": "DESC",
                        },
                        "tag": "OrderByItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "DateInserted",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "tag": "Limit",
                    "value": Object {
                      "tag": "Count",
                      "value": "1",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "ActualSwitchDate",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": Object {
                            "tag": "As",
                            "value": Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                          },
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "fit",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "Switch",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "s",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "InstallationId",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "i",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "InstallationId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                  Object {
                    "tag": "OrderBy",
                    "values": Array [
                      Object {
                        "direction": Object {
                          "tag": "OrderDirection",
                          "value": "DESC",
                        },
                        "tag": "OrderByItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "s",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "DateInserted",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "tag": "Limit",
                    "value": Object {
                      "tag": "Count",
                      "value": "1",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "CFRFiTId",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateInserted",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateUpdated",
                  },
                ],
              },
            },
          ],
        },
        Object {
          "join": Array [
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "InstallationType",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "it",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "it",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "InstallationTypeId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "i",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "InstallationTypeId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "GeneratorTechnologyType",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "gtt",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "gtt",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "GeneratorTechnologyTypeId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "i",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "GeneratorTechnologyTypeId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "PropertyType",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "pt",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "pt",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "PropertyTypeId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "i",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "PropertyTypeId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "GenerationAccountInstallation",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "gai",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "gai",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "InstallationId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "i",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "InstallationId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "GenerationAccount",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "ga",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ga",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "GenerationAccountId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "gai",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "GenerationAccountId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "CustomerAccount",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "ca",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ca",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "FitAccountId",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "ga",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "FitAccountId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "AND",
                    },
                    "right": Object {
                      "left": Object {
                        "left": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "ca",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "CustomerRoleValue",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "&",
                          },
                          "right": Object {
                            "tag": "Number",
                            "value": "1",
                          },
                          "tag": "BinaryExpression",
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": ">",
                        },
                        "right": Object {
                          "tag": "Number",
                          "value": "0",
                        },
                        "tag": "BinaryExpression",
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "OR",
                      },
                      "right": Object {
                        "left": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "ca",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "FitAccountId",
                            },
                          ],
                        },
                        "operator": Object {
                          "tag": "Operator",
                          "value": "=",
                        },
                        "right": Object {
                          "tag": "Number",
                          "value": "422",
                        },
                        "tag": "BinaryExpression",
                      },
                      "tag": "BinaryExpression",
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "Customer",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": "LEFT",
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "c",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "c",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "CustomerId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "ca",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "CustomerId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
          ],
          "list": Object {
            "tag": "FromList",
            "values": Array [
              Object {
                "as": Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "i",
                  },
                },
                "tag": "FromListItem",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "fit",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "Installation",
                    },
                  ],
                },
              },
            ],
          },
          "tag": "From",
        },
      ],
    },
    Object {
      "tag": "Conflict",
      "values": Array [
        Object {
          "tag": "ConflictTarget",
          "values": Array [
            Object {
              "as": undefined,
              "tag": "Table",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "source_system_id",
                  },
                ],
              },
            },
            Object {
              "tag": "Where",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "source_system_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "IS",
                },
                "right": Object {
                  "operator": Object {
                    "tag": "Operator",
                    "value": "NOT",
                  },
                  "tag": "UnaryExpression",
                  "value": Object {
                    "tag": "Null",
                  },
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "tag": "DoUpdate",
          "value": Object {
            "tag": "Set",
            "value": Object {
              "tag": "SetList",
              "values": Array [
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "address_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "address_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "name",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "name",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "type",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "type",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "technology_type",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "technology_type",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "property_type",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "property_type",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "export_type",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "export_type",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "commissioned_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "commissioned_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "decommissioned_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "decommissioned_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "eligibility_start_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "eligibility_start_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "eligibility_end_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "eligibility_end_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "installed_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "installed_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "verified_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "verified_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "reverified_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "reverified_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "inspected_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "inspected_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "mcs_reference",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "mcs_reference",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "tic_reference",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "tic_reference",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "dnc_reference",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "dnc_reference",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "roofit_reference",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "roofit_reference",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "name_of_grant",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "name_of_grant",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "value_of_grant",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "value_of_grant",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "date_grant_repaid",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "date_grant_repaid",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "epc_rate",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "epc_rate",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "epc_date",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "epc_date",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "epc_number",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "epc_number",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "has_battery_storage",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "has_battery_storage",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "battery_installation_date_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "battery_installation_date_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "export_mpan",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "export_mpan",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "supply_mpan",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "supply_mpan",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "switched_from",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "switched_from",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "switched_to",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "switched_to",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "switched_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "switched_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "legacy_fit_db_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "legacy_fit_db_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                },
              ],
            },
          },
          "where": undefined,
        },
      ],
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql meter-reads.sql: meter-reads.sql 1`] = `
Object {
  "tag": "Insert",
  "values": Array [
    Object {
      "as": undefined,
      "tag": "Table",
      "value": Object {
        "tag": "QualifiedIdentifier",
        "values": Array [
          Object {
            "tag": "Identifier",
            "value": "meter_reads",
          },
        ],
      },
    },
    Object {
      "tag": "Columns",
      "values": Array [
        Object {
          "tag": "Identifier",
          "value": "source_system_id",
        },
        Object {
          "tag": "Identifier",
          "value": "meter_id",
        },
        Object {
          "tag": "Identifier",
          "value": "date_on",
        },
        Object {
          "tag": "Identifier",
          "value": "value",
        },
        Object {
          "tag": "Identifier",
          "value": "type",
        },
        Object {
          "tag": "Identifier",
          "value": "reason",
        },
        Object {
          "tag": "Identifier",
          "value": "is_accepted",
        },
        Object {
          "tag": "Identifier",
          "value": "tolerance",
        },
        Object {
          "tag": "Identifier",
          "value": "created_at",
        },
        Object {
          "tag": "Identifier",
          "value": "updated_at",
        },
      ],
    },
    Object {
      "tag": "Select",
      "values": Array [
        Object {
          "tag": "SelectList",
          "values": Array [
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "mr",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "MeterReadingId",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Select",
                "values": Array [
                  Object {
                    "tag": "SelectList",
                    "values": Array [
                      Object {
                        "as": undefined,
                        "tag": "SelectListItem",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "meters",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "id",
                            },
                          ],
                        },
                      },
                    ],
                  },
                  Object {
                    "join": Array [],
                    "list": Object {
                      "tag": "FromList",
                      "values": Array [
                        Object {
                          "as": undefined,
                          "tag": "FromListItem",
                          "value": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "meters",
                              },
                            ],
                          },
                        },
                      ],
                    },
                    "tag": "From",
                  },
                  Object {
                    "tag": "Where",
                    "value": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "meters",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "source_system_id",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "=",
                      },
                      "right": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "mr",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "MeterId",
                          },
                        ],
                      },
                      "tag": "BinaryExpression",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "mr",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateOfReading",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "mr",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "MeterReadingValue",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "PgCast",
                "type": Object {
                  "param": undefined,
                  "tag": "Type",
                  "value": "meter_reads_types",
                },
                "value": Object {
                  "expression": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "mr",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "ReadType",
                      },
                    ],
                  },
                  "tag": "Case",
                  "values": Array [
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Closure",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Closing",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Closing",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Closing",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Clsoing",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Closing",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Final",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Closing",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "opening",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Opening",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Opening",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Opening",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Physical",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Meter Verification",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "Customer",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Quarterly",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "CUSTOMER",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Quarterly",
                      },
                    },
                    Object {
                      "condition": Object {
                        "tag": "String",
                        "value": "",
                      },
                      "tag": "When",
                      "value": Object {
                        "tag": "String",
                        "value": "Quarterly",
                      },
                    },
                  ],
                },
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "mr",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "ReadReason",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Case",
                "values": Array [
                  Object {
                    "condition": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "mr",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "DateOfReading",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "<=",
                      },
                      "right": Object {
                        "tag": "String",
                        "value": "2021-03-31",
                      },
                      "tag": "BinaryExpression",
                    },
                    "tag": "When",
                    "value": Object {
                      "tag": "Boolean",
                      "value": "TRUE",
                    },
                  },
                  Object {
                    "tag": "Else",
                    "value": Object {
                      "tag": "Boolean",
                      "value": "FALSE",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "Case",
                "values": Array [
                  Object {
                    "condition": Object {
                      "left": Object {
                        "tag": "QualifiedIdentifier",
                        "values": Array [
                          Object {
                            "tag": "Identifier",
                            "value": "mr",
                          },
                          Object {
                            "tag": "Identifier",
                            "value": "DateOfReading",
                          },
                        ],
                      },
                      "operator": Object {
                        "tag": "Operator",
                        "value": "<=",
                      },
                      "right": Object {
                        "tag": "String",
                        "value": "2021-03-31",
                      },
                      "tag": "BinaryExpression",
                    },
                    "tag": "When",
                    "value": Object {
                      "tag": "PgCast",
                      "type": Object {
                        "param": undefined,
                        "tag": "Type",
                        "value": "jsonb",
                      },
                      "value": Object {
                        "tag": "String",
                        "value": "{\\"success\\":true}",
                      },
                    },
                  },
                  Object {
                    "tag": "Else",
                    "value": Object {
                      "tag": "Null",
                    },
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "mr",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateInserted",
                  },
                ],
              },
            },
            Object {
              "as": undefined,
              "tag": "SelectListItem",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "mr",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "DateUpdated",
                  },
                ],
              },
            },
          ],
        },
        Object {
          "join": Array [
            Object {
              "table": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "fit",
                  },
                  Object {
                    "tag": "Identifier",
                    "value": "Meter",
                  },
                ],
              },
              "tag": "Join",
              "type": Object {
                "tag": "JoinType",
                "value": undefined,
              },
              "values": Array [
                Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "m",
                  },
                },
                Object {
                  "tag": "JoinOn",
                  "value": Object {
                    "left": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "m",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "MeterId",
                        },
                      ],
                    },
                    "operator": Object {
                      "tag": "Operator",
                      "value": "=",
                    },
                    "right": Object {
                      "tag": "QualifiedIdentifier",
                      "values": Array [
                        Object {
                          "tag": "Identifier",
                          "value": "mr",
                        },
                        Object {
                          "tag": "Identifier",
                          "value": "MeterId",
                        },
                      ],
                    },
                    "tag": "BinaryExpression",
                  },
                },
              ],
            },
          ],
          "list": Object {
            "tag": "FromList",
            "values": Array [
              Object {
                "as": Object {
                  "tag": "As",
                  "value": Object {
                    "tag": "Identifier",
                    "value": "mr",
                  },
                },
                "tag": "FromListItem",
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "fit",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "MeterReading",
                    },
                  ],
                },
              },
            ],
          },
          "tag": "From",
        },
        Object {
          "tag": "Where",
          "value": Object {
            "left": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "m",
                },
                Object {
                  "tag": "Identifier",
                  "value": "MPAN",
                },
              ],
            },
            "operator": Object {
              "tag": "Operator",
              "value": "IS",
            },
            "right": Object {
              "operator": Object {
                "tag": "Operator",
                "value": "NOT",
              },
              "tag": "UnaryExpression",
              "value": Object {
                "tag": "Null",
              },
            },
            "tag": "BinaryExpression",
          },
        },
      ],
    },
    Object {
      "tag": "Conflict",
      "values": Array [
        Object {
          "tag": "ConflictTarget",
          "values": Array [
            Object {
              "as": undefined,
              "tag": "Table",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "source_system_id",
                  },
                ],
              },
            },
            Object {
              "tag": "Where",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "source_system_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "IS",
                },
                "right": Object {
                  "operator": Object {
                    "tag": "Operator",
                    "value": "NOT",
                  },
                  "tag": "UnaryExpression",
                  "value": Object {
                    "tag": "Null",
                  },
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "tag": "DoUpdate",
          "value": Object {
            "tag": "Set",
            "value": Object {
              "tag": "SetList",
              "values": Array [
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "meter_id",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "meter_id",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "date_on",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "date_on",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "value",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "value",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "type",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "type",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "reason",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "reason",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "is_accepted",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "Case",
                    "values": Array [
                      Object {
                        "condition": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "meter_reads",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "value",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "=",
                          },
                          "right": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "EXCLUDED",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "value",
                              },
                            ],
                          },
                          "tag": "BinaryExpression",
                        },
                        "tag": "When",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "meter_reads",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "is_accepted",
                            },
                          ],
                        },
                      },
                      Object {
                        "tag": "Else",
                        "value": Object {
                          "tag": "Boolean",
                          "value": "FALSE",
                        },
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "tolerance",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "Case",
                    "values": Array [
                      Object {
                        "condition": Object {
                          "left": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "meter_reads",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "value",
                              },
                            ],
                          },
                          "operator": Object {
                            "tag": "Operator",
                            "value": "=",
                          },
                          "right": Object {
                            "tag": "QualifiedIdentifier",
                            "values": Array [
                              Object {
                                "tag": "Identifier",
                                "value": "EXCLUDED",
                              },
                              Object {
                                "tag": "Identifier",
                                "value": "value",
                              },
                            ],
                          },
                          "tag": "BinaryExpression",
                        },
                        "tag": "When",
                        "value": Object {
                          "tag": "QualifiedIdentifier",
                          "values": Array [
                            Object {
                              "tag": "Identifier",
                              "value": "meter_reads",
                            },
                            Object {
                              "tag": "Identifier",
                              "value": "tolerance",
                            },
                          ],
                        },
                      },
                      Object {
                        "tag": "Else",
                        "value": Object {
                          "tag": "Null",
                        },
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                },
              ],
            },
          },
          "where": undefined,
        },
      ],
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql rates-by-tarrif-ids.query.sql: rates-by-tarrif-ids.query.sql 1`] = `
Object {
  "tag": "Select",
  "values": Array [
    Object {
      "tag": "SelectList",
      "values": Array [
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "tariffId",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "r",
              },
              Object {
                "tag": "Identifier",
                "value": "tariff_id",
              },
            ],
          },
        },
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "r",
              },
              Object {
                "tag": "Identifier",
                "value": "rate",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "startOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "r",
              },
              Object {
                "tag": "Identifier",
                "value": "start_date_on",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "tariffCode",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "t",
              },
              Object {
                "tag": "Identifier",
                "value": "code",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "tariffType",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "t",
              },
              Object {
                "tag": "Identifier",
                "value": "type",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "endOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "r",
              },
              Object {
                "tag": "Identifier",
                "value": "end_date_on",
              },
            ],
          },
        },
      ],
    },
    Object {
      "join": Array [
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "tariffs",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "t",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "r",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "tariff_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "t",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
      ],
      "list": Object {
        "tag": "FromList",
        "values": Array [
          Object {
            "as": Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "r",
              },
            },
            "tag": "FromListItem",
            "value": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "tariff_rates",
                },
              ],
            },
          },
        ],
      },
      "tag": "From",
    },
    Object {
      "tag": "Where",
      "value": Object {
        "left": Object {
          "left": Object {
            "left": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "start_date_on",
                },
              ],
            },
            "operator": Object {
              "tag": "Operator",
              "value": "<",
            },
            "right": Object {
              "args": Array [],
              "tag": "Function",
              "value": Object {
                "tag": "Identifier",
                "value": "NOW",
              },
            },
            "tag": "BinaryExpression",
          },
          "operator": Object {
            "tag": "Operator",
            "value": "and",
          },
          "right": Object {
            "left": Object {
              "left": Object {
                "tag": "PgCast",
                "type": Object {
                  "param": undefined,
                  "tag": "Type",
                  "value": "date",
                },
                "value": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "end_date_on",
                    },
                  ],
                },
              },
              "operator": Object {
                "tag": "Operator",
                "value": "IS",
              },
              "right": Object {
                "tag": "Null",
              },
              "tag": "BinaryExpression",
            },
            "operator": Object {
              "tag": "Operator",
              "value": "OR",
            },
            "right": Object {
              "left": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "end_date_on",
                  },
                ],
              },
              "operator": Object {
                "tag": "Operator",
                "value": ">",
              },
              "right": Object {
                "args": Array [],
                "tag": "Function",
                "value": Object {
                  "tag": "Identifier",
                  "value": "NOW",
                },
              },
              "tag": "BinaryExpression",
            },
            "tag": "BinaryExpression",
          },
          "tag": "BinaryExpression",
        },
        "operator": Object {
          "tag": "Operator",
          "value": "AND",
        },
        "right": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "t",
              },
              Object {
                "tag": "Identifier",
                "value": "id",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "IN",
          },
          "right": Object {
            "tag": "Parameter",
            "type": "values",
            "value": "ids",
          },
          "tag": "BinaryExpression",
        },
        "tag": "BinaryExpression",
      },
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql reads-by-account-id.query.sql: reads-by-account-id.query.sql 1`] = `
Object {
  "tag": "Select",
  "values": Array [
    Object {
      "tag": "SelectList",
      "values": Array [
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "mr",
              },
              Object {
                "tag": "Identifier",
                "value": "id",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "msn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "m",
              },
              Object {
                "tag": "Identifier",
                "value": "serial_number",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "meterId",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "mr",
              },
              Object {
                "tag": "Identifier",
                "value": "meter_id",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "dateOn",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "date_on",
              },
            ],
          },
        },
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "value",
              },
            ],
          },
        },
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "mr",
              },
              Object {
                "tag": "Identifier",
                "value": "type",
              },
            ],
          },
        },
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "reason",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "createdAt",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "mr",
              },
              Object {
                "tag": "Identifier",
                "value": "created_at",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "updatedAt",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "mr",
              },
              Object {
                "tag": "Identifier",
                "value": "updated_at",
              },
            ],
          },
        },
        Object {
          "as": Object {
            "tag": "As",
            "value": Object {
              "tag": "Identifier",
              "value": "sourceSystemId",
            },
          },
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "mr",
              },
              Object {
                "tag": "Identifier",
                "value": "source_system_id",
              },
            ],
          },
        },
        Object {
          "as": undefined,
          "tag": "SelectListItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "m",
              },
              Object {
                "tag": "Identifier",
                "value": "mpan",
              },
            ],
          },
        },
      ],
    },
    Object {
      "join": Array [
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "meters",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "m",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "m",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "mr",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "meter_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "installation_meters",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "im",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "im",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "mr",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "meter_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "installations",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "i",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "i",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "im",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "installation_id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "table": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "contracts",
              },
            ],
          },
          "tag": "Join",
          "type": Object {
            "tag": "JoinType",
            "value": "LEFT",
          },
          "values": Array [
            Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "c",
              },
            },
            Object {
              "tag": "JoinOn",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "c",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "=",
                },
                "right": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "i",
                    },
                    Object {
                      "tag": "Identifier",
                      "value": "id",
                    },
                  ],
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
      ],
      "list": Object {
        "tag": "FromList",
        "values": Array [
          Object {
            "as": Object {
              "tag": "As",
              "value": Object {
                "tag": "Identifier",
                "value": "mr",
              },
            },
            "tag": "FromListItem",
            "value": Object {
              "tag": "QualifiedIdentifier",
              "values": Array [
                Object {
                  "tag": "Identifier",
                  "value": "meter_reads",
                },
              ],
            },
          },
        ],
      },
      "tag": "From",
    },
    Object {
      "tag": "Where",
      "value": Object {
        "left": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "mr",
              },
              Object {
                "tag": "Identifier",
                "value": "deleted_at",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "IS",
          },
          "right": Object {
            "tag": "Null",
          },
          "tag": "BinaryExpression",
        },
        "operator": Object {
          "tag": "Operator",
          "value": "AND",
        },
        "right": Object {
          "left": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "c",
              },
              Object {
                "tag": "Identifier",
                "value": "account_id",
              },
            ],
          },
          "operator": Object {
            "tag": "Operator",
            "value": "=",
          },
          "right": Object {
            "tag": "Parameter",
            "type": "native",
            "value": "id",
          },
          "tag": "BinaryExpression",
        },
        "tag": "BinaryExpression",
      },
    },
    Object {
      "tag": "OrderBy",
      "values": Array [
        Object {
          "direction": Object {
            "tag": "OrderDirection",
            "value": "desc",
          },
          "tag": "OrderByItem",
          "value": Object {
            "tag": "QualifiedIdentifier",
            "values": Array [
              Object {
                "tag": "Identifier",
                "value": "mr",
              },
              Object {
                "tag": "Identifier",
                "value": "id",
              },
            ],
          },
        },
      ],
    },
    Object {
      "tag": "Offset",
      "value": Object {
        "tag": "Count",
        "value": Object {
          "tag": "Parameter",
          "type": "native",
          "value": "offset",
        },
      },
    },
    Object {
      "tag": "Limit",
      "value": Object {
        "tag": "Count",
        "value": Object {
          "tag": "Parameter",
          "type": "native",
          "value": "perPage",
        },
      },
    },
  ],
}
`;

exports[`Sql Files Should parse complex sql tariff-rates.sql: tariff-rates.sql 1`] = `
Object {
  "tag": "Insert",
  "values": Array [
    Object {
      "as": undefined,
      "tag": "Table",
      "value": Object {
        "tag": "QualifiedIdentifier",
        "values": Array [
          Object {
            "tag": "Identifier",
            "value": "tariffs",
          },
        ],
      },
    },
    Object {
      "tag": "Columns",
      "values": Array [
        Object {
          "tag": "Identifier",
          "value": "source_system_id",
        },
        Object {
          "tag": "Identifier",
          "value": "code",
        },
        Object {
          "tag": "Identifier",
          "value": "type",
        },
      ],
    },
    Object {
      "tag": "ValuesList",
      "values": Array [
        Object {
          "tag": "Values",
          "values": Array [
            Object {
              "tag": "Number",
              "value": "100001",
            },
            Object {
              "tag": "String",
              "value": "ALL/EXPORT/01",
            },
            Object {
              "tag": "PgCast",
              "type": Object {
                "param": undefined,
                "tag": "Type",
                "value": "tariff_types",
              },
              "value": Object {
                "tag": "String",
                "value": "Export",
              },
            },
          ],
        },
        Object {
          "tag": "Values",
          "values": Array [
            Object {
              "tag": "Number",
              "value": "100002",
            },
            Object {
              "tag": "String",
              "value": "ALL/EXPORT/02",
            },
            Object {
              "tag": "PgCast",
              "type": Object {
                "param": undefined,
                "tag": "Type",
                "value": "tariff_types",
              },
              "value": Object {
                "tag": "String",
                "value": "Export",
              },
            },
          ],
        },
      ],
    },
    Object {
      "tag": "Conflict",
      "values": Array [
        Object {
          "tag": "ConflictTarget",
          "values": Array [
            Object {
              "as": undefined,
              "tag": "Table",
              "value": Object {
                "tag": "QualifiedIdentifier",
                "values": Array [
                  Object {
                    "tag": "Identifier",
                    "value": "source_system_id",
                  },
                ],
              },
            },
            Object {
              "tag": "Where",
              "value": Object {
                "left": Object {
                  "tag": "QualifiedIdentifier",
                  "values": Array [
                    Object {
                      "tag": "Identifier",
                      "value": "source_system_id",
                    },
                  ],
                },
                "operator": Object {
                  "tag": "Operator",
                  "value": "IS",
                },
                "right": Object {
                  "operator": Object {
                    "tag": "Operator",
                    "value": "NOT",
                  },
                  "tag": "UnaryExpression",
                  "value": Object {
                    "tag": "Null",
                  },
                },
                "tag": "BinaryExpression",
              },
            },
          ],
        },
        Object {
          "tag": "DoUpdate",
          "value": Object {
            "tag": "Set",
            "value": Object {
              "tag": "SetList",
              "values": Array [
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "code",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "code",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "type",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "type",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "created_at",
                      },
                    ],
                  },
                },
                Object {
                  "column": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                  "tag": "SetItem",
                  "value": Object {
                    "tag": "QualifiedIdentifier",
                    "values": Array [
                      Object {
                        "tag": "Identifier",
                        "value": "EXCLUDED",
                      },
                      Object {
                        "tag": "Identifier",
                        "value": "updated_at",
                      },
                    ],
                  },
                },
              ],
            },
          },
          "where": undefined,
        },
      ],
    },
  ],
}
`;
